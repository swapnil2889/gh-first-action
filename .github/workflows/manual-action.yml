name: Manual Deploy Workflow

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Target environment'
        required: true
        default: 'dev'
        type: choice
        options:
          - dev
          - stg
          - prd
      branch:
        description: 'Branch to deploy'
        required: true
        default: 'develop'
        type: string

jobs:
  # Build & deploy for non-prd (dev/stg)
  build-deploy-nonprd:
    if: ${{ github.event.inputs.environment != 'prd' }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.inputs.branch }}
      - name: Build
        run: |
          echo "Building for ${{ github.event.inputs.environment }} from branch ${{ github.event.inputs.branch }}"
          # Insert your real build commands here
      - name: Deploy
        run: |
          echo "Deploying to ${{ github.event.inputs.environment }}"
          # Insert your real deploy commands here

  # Build & deploy for prd — this job is tied to the protected 'prd' environment,
  # so it will pause and require approval when it reaches the job.
  build-deploy-prd:
    if: ${{ github.event.inputs.environment == 'prd' }}
    runs-on: ubuntu-latest
    environment: prd
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.inputs.branch }}
      - name: Build (PRD)
        run: |
          echo "Building for PRODUCTION from branch ${{ github.event.inputs.branch }}"
          # Insert your production build commands here
      - name: Deploy (PRD)
        run: |
          echo "Deploying to PRODUCTION"
          # Insert your production deploy commands here